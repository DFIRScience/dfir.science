---
layout: posts
title: "Automata Intersection to Test Possibility of Statements in Investigations"
date: '2013-03-11T18:00:00.000+09:00'
author: Joshua
tags:
- Formal Methods
- Research
modified_time: '2013-03-11T19:41:01.398+09:00'
thumbnail: http://3.bp.blogspot.com/-upYW_ROIG9E/UTwL9k_TV3I/AAAAAAAAApg/dwiEsCjKEzQ/s72-c/ID-10095112.jpg
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-6457289036735473770
blogger_orig_url: https://DFIR.Science/2013/03/automata-intersection-to-test.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-upYW_ROIG9E/UTwL9k_TV3I/AAAAAAAAApg/dwiEsCjKEzQ/s1600/ID-10095112.jpg" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="http://3.bp.blogspot.com/-upYW_ROIG9E/UTwL9k_TV3I/AAAAAAAAApg/dwiEsCjKEzQ/s200/ID-10095112.jpg" width="200" /></a></div>As seen on <a href="http://digitalfire.ucd.ie/?p=109" target="_blank">DigitalFIRE</a>.<br /><br />When conducting an investigation, many statements are given by witnesses and suspects. A "witness" could be considered as anything that provides information about the occurrence of an event. While a witness may traditionally be a human, a digital device - such as a computer or cell phone - could also help to provide information about an event. Once a witness provides a statement, the investigator needs to evaluate the level of trust he or she places in the validity of the statement. For example, a statement from a witness that is known to lie may be considered less trustworthy Similarly, in the digital realm, information gathered from a device may be less trustworthy if the device has been known to be compromised by a hacker or virus.<br /><br />When an investigator gets statements from witnesses, the investigator can then begin to restrict&nbsp;possibilities of happened events based on the information. For example, if a trustworthy witness says she saw a specific suspect at a specific time, and the suspect claims to be out of the country at that time, these are conflicting statements. A witness statement may not be true for a number of reasons, but the statement may be highly probable. At a minimum when conflicting statements occur, these indicate that one or both statements should be investigated further to find either inculpatory or exculpatory evidence.<br /><br />If an action happens that affects a computer system, observation of the affected data in the system could be used a evidence to reduce the possible states the system could have been in before it's current state. Taking this further, if we create a complete model of a system then without any restriction on the model, any state of the system could possibly be reachable.<br /><br />Computer systems can be modeled as <a href="http://en.wikipedia.org/wiki/Automata_theory" target="_blank">finite state automata</a>&nbsp;(FSA). In this model, each state of the system is represented as a state in the FSA. The set of all states is defined as Q.&nbsp;Each action that alters the state of the system can be represented as a symbol in the alphabet (Σ) of the&nbsp;automaton. Moving from one state to another is controlled by a&nbsp;transition&nbsp;function δ&nbsp;where&nbsp;δ:&nbsp;Q&nbsp;×&nbsp;Σ&nbsp;→&nbsp;Q.<br /><br />In the case of an investigation of a computer system, the investigator may be able to directly observe only the final state of the system. The set of final, or accepting, states is defined as&nbsp;F, where&nbsp;F ⊆ Q. The start state (q<sub>0</sub>, where&nbsp;q<sub>0</sub>∈ Q) is likely to be unobservable, and may be unknown. Because of this, any state in the model may potentially be a start state. To account for this, a generic start state g, where&nbsp; g ∉<em> </em>Q, can be defined. g is a generic start state with a&nbsp;tradition to each state in Q on each input leading to that particular state. The result of this process is a model of the system that allows for any possible transitions in the system that result in the observed final state from any starting state.<br /><br />This FSA of the system can then be used to test statements about interactions with the system. As a very basic example, consider an FSA with only two states. The first state is the system before a program is ran, and no prefetch entry has been created (!PrefetchX). The second state is after a program has been ran, and a prefetch entry has been created (PrefetchX). The transition symbol is defined as "Run_Program_X". The FSA can be&nbsp;visualized&nbsp;as:<br /><br />(!PrefetchX) -&gt; Run_Program_X -&gt; (PrefetchX)<br /><br />For the sake of this example, it is known that a prefetch entry will not be created unless a program is ran, so the start state is defined as (!PrefetchX). An investigator observes that in the final state of the system PrefetchX did exist, so the final accepting state is (PrefetchX).<br /><br />A suspect who normally uses the system is asked whether they executed Program X, and she claims she did not. Her statement may then also be modeled in terms of the previous FSA, where any transition is allowed&nbsp;<em>except</em> "Run_Program_X". Her statement can be visualized as:&nbsp; <br /><br />(*) -&gt; !Run_Program_X -&gt; (*)<br /><br />In this statement, she is claiming that any state and transition is possible except for "Run_Program_X".  When both the system and the suspect's statement are modeled, the FSA can be intersected to determine if the final observed state of the system is reachable with the restrictions the suspect statement places on the model. In the given example, the only possible transition to get to the observed final state is Run_Program_X. If the system model were intersected with the suspect's statement, the final state (PrefetchX) would not be reachable because the transition that leads to the final state would not be possible. In this case, the suspect statement is inconsistent with the observed final state, and should therefore be investigated further.<br /><br />This very simple example can be applied to more complex situations and models; however, a challenge with using a computational approach to model real-world systems is a very large state-space to model even for&nbsp;relatively&nbsp;simple systems.<br /><br />For a more in-depth&nbsp;explanation, please see&nbsp;<a href="http://rd.springer.com/chapter/10.1007/978-3-642-11534-9_9"><em>Analysis of Evidence Using Formal Event Reconstruction</em></a>.<br /><br />[1] James, J., P. Gladyshev, M.T. Abdullah, Y. Zhu. (2010) "Analysis of Evidence Using Formal Event Reconstruction." Digital Forensics and Cyber Crime 31: 85-98. [<a href="http://digitalfire.ucd.ie/wp-content/uploads/2013/01/Analysis-of-Evidence-using-Formal-Event-Reconstruction.pdf" title="Analysis of Evidence Using Formal Event Reconstruction">PDF</a>][<a href="http://arxiv.org/abs/1302.2308" style="background-color: white; font-family: 'Lucida Grande', helvetica, arial, verdana, sans-serif; font-size: 14.44444465637207px;" title="Abstract">arXiv:1302.2308</a>]<br /><br /><span style="font-size: x-small;">Image courtesy of Stuart Miles / <a href="http://www.freedigitalphotos.net/" target="_blank">FreeDigitalPhotos.net</a></span>