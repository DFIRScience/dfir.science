---
layout: single
title: "pt.3 OCFA Installation - DNS, Apache and Permissions"
date: '2009-01-13T06:45:00.000+09:00'
author: Joshua
tags:
- HowTo
modified_time: '2015-08-24T22:35:19.173+09:00'
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-4039637962860614246
blogger_orig_url: https://DFIR.Science/2009/01/pt3-ocfa-installation-dns-apache-and.html
---

After completing pt.1 and pt.2 BIND, Apache and some permissions still need to be set before everything will work all hunky-dory.<br /><br /><span style="font-weight: bold;">Setting up DNS</span><br />Navigate to /etc/bind/<br />Edit the file ‘named.conf.local’<br />Add:<code><br />Zone “loc” {<br />   Type master;<br />   File “/etc/bind/loc.hosts”;<br />   };</code><br /><br />Create the file ‘/etc/bind/loc.hosts<br />Add:<code><br />$ttl 38400<br />loc.    IN    SOA    serverName.  Temp.invalid.com. (<br />                                 2006081401<br />                                 28800<br />                                 3600<br />                                 604800<br />                                 38400             )<br />loc.    IN    NS    serverName.<br />*.ocfa.loc.    IN    A    IPAddress</code><br /><br />where 'serverName' is the name of the DNS server, and 'serverIPAddress' is the address of the server running Apache (the IP you want to resolve to)<br /><br />Save 'loc.hosts', and restart bind for good measure.<br />Update local machine DNS, and ping monkey.ocfa.loc<br /><code>/etc/init.d/bind9 restart</code><br /><br />Update the DNS servers on your local machine. Add the IP address of your newly created OCFA/DNS server. Now you should be able to ping any domain name from your local machine ending with 'ocfa.loc'<br /><br />Try: 'ping monkey.ocfa.oc' - if you get a reply then DNS is working.<br />*Because it is a wildcard DNS entry anything ending with the ocfa.loc domain will resolve to the address assigned to the (server's IP address)<br /><br /><span style="font-weight: bold;">Apache and Permissions for the OCFA user</span><br />Before we being you will need to install some more packages to allow the cgi scripts to run. Install the following:<code><br />apt-get install libpg-perl libxml-dom-perl</code><br />Now to create a case you must log in as the newly created ocfa user.<br />*If you are use 'su' to switch to ocfa, make sure you use the 'su - ocfa' switch to load environment variables.<br /><br />You will be prompted for a case name. Just to test lets use 'test'. The case should not have been created already, and you will get a message telling you to run 'createcase.pl'. Attempt to run this by typing 'createcase.pl test ocfa'.<br /><br />At this point I have always gotten a 'permission denied' error. To remedy this, log in as 'root', and navigate to '/usr/local/ocfa(version)/'<br />Set permissions to 755 for the bin directory.<code><br />cd /usr/local/ocfa(version)/bin<br />chmod 755 *</code><br /><br />Do the same for the following directories under 'ocfa(version)/': html, cgi-bin, sbin<br /><br />Log back in as ocfa, and you should be able to run the script with 'createcase.pl test ocfa'. Now (as root) restart apache with '/etc/init.d/apache2 restart'<br /><br />*If you are still getting a permission denied, make sure you are changing permissions on the files, and not on the directory itself.<br /><br />Now you can open a browser on your local computer, and navigate to 'casename.ocfa.loc' where 'casename' is the case you just created. In this example I am using 'test.ocfa.loc'<br /><br />You should get a page displaying the case name.<br /><br />If you get a '500 - Internal Server Error' message, ensure the directories listed above are set to '755'. If permissions are correct, check '/var/log/apache2/error.log'.<br />Most of the errors I received were similar to this:<br /><blockquote>If error: “can’t locate Pg.pm in @INC (@INC contains: blab la) at /usr/local/ocfa2.1.1pl0/html/index.cgi line 20”</blockquote><br />In cases such as this, it was usually a perl module that needed to be installed. Verify that you did install the 'libpg-perl libxml-dom-perl' packages. If so try searching google and the apt repositories for the cause of the error; 'Pg.pm' in this case.<br /><br />If you were successful you should be able to access OCFA from a browser to view added evidence.<br /><br />Please see singles labeled 'OCFAHowTo' for instructions on using the Open Computer Forensic Architecture to analyze evidence.