---
layout: single
title: "[How-To] Using GnuPG to verify data using detached signatures"
date: '2015-07-02T16:00:00.000+09:00'

tags:
- GPG
- Encryption
- Hashing
- HowTo
modified_time: '2015-08-24T22:35:19.354+09:00'
thumbnail: http://3.bp.blogspot.com/-y02WonbXCI4/VZEO-GgtB6I/AAAAAAAAA98/rHkjJKno89I/s72-c/Screenshot%2Bfrom%2B2015-06-29%2B18%253A22%253A03.png
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-7669964127787698337
blogger_orig_url: https://DFIR.Science/2015/07/how-to-using-gnupg-to-verify-data-using.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="https://www.gnupg.org/share/logo-gnupg-light-purple-bg.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img alt="GnuPG logo" border="0" height="66" src="https://www.gnupg.org/share/logo-gnupg-light-purple-bg.png" title="GnuPG logo" width="200" /></a></div><div><br /></div>Many software downloads come with a signature file. You normally need to download this signature file separately. Signatures are a great way to let people know that you are the person / company that is making the software available, and that no one else has changed the data since its release.<br /><div><br /></div><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-y02WonbXCI4/VZEO-GgtB6I/AAAAAAAAA98/rHkjJKno89I/s1600/Screenshot%2Bfrom%2B2015-06-29%2B18%253A22%253A03.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img alt="Tails linux ISO and signature download links with SHA256 checksum" border="0" height="320" src="http://3.bp.blogspot.com/-y02WonbXCI4/VZEO-GgtB6I/AAAAAAAAA98/rHkjJKno89I/s320/Screenshot%2Bfrom%2B2015-06-29%2B18%253A22%253A03.png" title="Tails linux ISO and signature download links with SHA256 checksum" width="305" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Fig 1: Tails ISO and signature file download</td></tr></tbody></table><div>We are going to use <a href="https://tails.boum.org/" target="_blank">Tails Linux</a> as an example. On their download page, you will find a link to download the Tails ISO image. This is the data we are interested in running. Think of it like the main program that we want to install / use.</div><div><br /></div><div>Next, we are given a link to the "Tails 1.4 signature". This is signature file that the distributor created. With this signature we can verify that the Tails ISO Image has not been modified by anyone else.</div><div><br /></div><div>Tails also provides a "SHA256 Checksum". This is a less-rigorous way than signatures to verify the data has not changed.</div><div><br /></div><div>First, download the ISO file AND the signature file. The signature file will almost always end with ".sig". Make sure both files are in the same directory.</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-jiyV5Merq-Q/VZERF9pZtPI/AAAAAAAAA-I/vVwsgU1o2o4/s1600/Screenshot%2Bfrom%2B2015-06-29%2B18%253A34%253A04.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="36" src="http://4.bp.blogspot.com/-jiyV5Merq-Q/VZERF9pZtPI/AAAAAAAAA-I/vVwsgU1o2o4/s400/Screenshot%2Bfrom%2B2015-06-29%2B18%253A34%253A04.png" width="400" /></a></div><div><br /></div><div>Once you had both files, open the command line / terminal and navigate to that directory. Next we need to use gpg to verify the signature. If we try to verify now, we may get the following results:</div><div><br /></div><pre>gpg2 --verify tails-i386-1.4.iso.sig gpg: assuming signed data in 'tails-i386-1.4.iso'<br />gpg: Signature made Tue 12 May 2015 02:56:27 AM KST using RSA key ID 752A3DB6<br />gpg: Can't check signature: No public key<br /></pre><br />In this case, we also need to get the public key of the person that created the signature. From the tails website, I find the ID of their signing key, so now we need to import. <br /><br /><pre><b>gpg2 --recv-keys A490D0F4D311A4153E2BB7CADBB802B258ACD84F</b><br />gpg: key 58ACD84F: public key "Tails developers (offline long-term identity key) <tails boum.org=">" imported<br />gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model<br />gpg: depth: 0  valid:   2  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 2u<br />gpg: next trustdb check due at 2017-01-09<br />gpg: Total number processed: 1<br />gpg:               imported: 1<br /></tails></pre><br />Make sure we have the right key: <br /><br /><pre><b>gpg2 --list-keys</b><br />pub   rsa4096/58ACD84F 2015-01-18 [expires: 2016-01-11]<br />uid       [ unknown] Tails developers (offline long-term identity key) <tails boum.org="><br />sub   rsa4096/752A3DB6 2015-01-18 [expires: 2016-01-11]<br />sub   rsa4096/2F699C56 2015-01-18 [expires: 2016-01-11]<br /></tails></pre><br />Now verify the signature again: <br /><br /><pre><b>gpg2 --verify tails-i386-1.4.iso.sig gpg: assuming signed data in 'tails-i386-1.4.iso'</b><br />gpg: Signature made Tue 12 May 2015 02:56:27 AM KST using RSA key ID 752A3DB6<br />gpg: Good signature from "Tails developers (offline long-term identity key) <tails boum.org=">" [unknown]<br />gpg: WARNING: This key is not certified with a trusted signature!<br />gpg:          There is no indication that the signature belongs to the owner.<br />Primary key fingerprint: A490 D0F4 D311 A415 3E2B  B7CA DBB8 02B2 58AC D84F<br />     Subkey fingerprint: BA2C 222F 44AC 00ED 9899  3893 98FE C6BC 752A 3DB6<br /></tails></pre><br />Here we can see when the signature was made, and the ID of that key. Next we see "Good signature" which means that the signature does verify the data. <br /><br />Remember, we were given the SHA256 value of the ISO file. Get the SHA256 hash with the following command (linux): <br /><br /><pre><b>sha256sum tails-i386-1.4.iso</b><br />339c8712768c831e59c4b1523002b83ccb98a4fe62f6a221fee3a15e779ca65d  tails-i386-1.4.iso<br /></pre><br />Now can can compare this hash value to the one on the website, and we see that they are the same.<br /><h3>If I can just check the hash value, why verify with a signature?</h3><div>Hash values do allow you to make sure that the data has not changed, however, there are a number of weaknesses. For example, someone intercepting your network traffic could deliver the web page to you with an altered ISO link AND an altered hash value on the page. This means that the hash value will be valid, but the source of the information cannot be trusted.</div><div><br /></div><div>Signatures help this in a number of ways. Because the signature is generated by a developer's private key, and we are verifying it with their public key, it is nearly impossible for someone to pretend to be the developer. Also, since we did not download the public key from the webpage, but looked it up on a different server, it is slightly more difficult for someone to trick us into download the wrong key. Further, we can try to use the <a href="https://en.wikipedia.org/wiki/Web_of_trust" target="_blank">Web of Trust</a> to make sure we are getting the right key. In our case, we can see who has signed this key by <a href="https://pgp.mit.edu/pks/lookup?op=vindex&amp;search=0xDBB802B258ACD84F" target="_blank">going to a keyserver checking</a>.</div>