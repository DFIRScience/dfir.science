---
layout: single
title: "pt.2 OCFA Installation - Prep and Building"
date: '2009-01-07T20:16:00.000+09:00'
author: Joshua
tags:
- HowTo
modified_time: '2015-08-24T22:35:19.103+09:00'
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-1917113465045409136
blogger_orig_url: https://DFIR.Science/2009/01/pt2-ocfa-installation-prep-and-building.html
---

Now that we have a working Debian install, we can get it ready for OCFA.<br /><br />Again this is s supplement to the 'HOWTO-INSTALL-debian-etch.txt' found in /ocfa/doc/usage/<br /><br />After <a href="https://DFIR.Science/2009/01/pt1-ocfa-installation-introductionos.html">pt.1</a> we have a basic Debian install with a File (samba) and DNS (BIND) services.<br /><br />[ocfaShare]<br />If your server is on a trusted network you might consider creating a temporary share for packages you will need to download manually (like OCFA). To set this up please refer to the single '<a href="https://DFIR.Science/2009/01/ocfa-installation-creating-temporary.html">OCFA Installation - temporary Share</a>'<br /><br /><span style="font-weight: bold;">Updating Apt Sources</span><br />Edit /etc/apt/sources.list and comment (put a # before) any instance that starts with 'deb cdrom:'<br />This make sure 1) you get the newest software versions from apt, and 2) you don't need mess with the install CD anymore.<br />Also, add the non-free repositories by adding non-free to the end of the source. For example:<br /><code>deb http://ftp.ie.debian.org/debian/ etch main <span style="font-weight: bold;">non-free</span><br />deb-src http://ftp.ie.debian.org/debian/ etch main <span style="font-weight: bold;">non-free</span></code><br />Save the updated sources.list file, and run '<span style="font-weight: bold;">apt-get update</span>'<br /><br /><br /><span style="font-weight: bold;">OCFA-Required Packages 4.0 (etch)</span><br />The following packages are said to be required in the install documentation.<br />Checked: Feb 19, 2009<br /><code>apt-get install bzip2 libxerces27-dev libtool libboost-dev<br />libboost-serialization-dev libssl-dev singlegresql-dev<br />libboost-regex-dev libdb4.4-dev exiftags unzip antiword<br />xpdf-utils libmagic-dev apache2 libmime-perl openssh-server<br />netpbm sleuthkit libcgicc1-dev libace-dev g++ libfuse-dev<br />fuse-utils lynx</code><br />*Note* As of the time of this writing the only difference is 'cgicc-dev' is now 'libcgicc1-dev'<br /><br />*Debian 5.0 has several packages that are different.*<br /><span style="font-weight: bold;">OCFA-Required Packages 5.0 (lenny)</span><br />Updated: Feb 19, 2009<br /><code>apt-get install bzip2 libxerces-c2-dev libtool libboost-dev<br />libboost-serialization-dev libssl-dev singlegresql<br />libboost-regex-dev libdb4.6-dev exiftags unzip antiword<br />xpdf-utils libmagic-dev apache2 libmime-perl openssh-server<br />netpbm sleuthkit libcgicc5-dev libace-dev g++ libfuse-dev<br />fuse-utils lynx libpq-dev</code><br /><br />If apt does not find the package in question you can try to search for it with the following command:<br /><code>apt-cache search (packageName)</code><br />Use can also use '| more' or '| grep (searchString)' if there are a lot of hits in the cache.<br /><br />I am also installing the 'Suggested Optional Packages'<br /><code>apt-get install libextractor-dev extract mdbtools nrg2iso</code><br />If your database will be hosted on the same server then you need:<br />etch<br /><code>apt-get install singlegresql-8.1</code><br />lenny - should already be installed<br /><code>apt-get install singlegresql-8.3</code><br />Since we are getting down-and-dirty with apt, next is a list of packages which will be required at various steps, but are neglected in the documentation (most are used with OCFA Modules):<br /><code>apt-get install make libsqlite3-dev p7zip-full ant testdisk<br />libspreadsheet-parseexcel-perl libmail-box-perl  sun-java5-jre<br />sun-java5-jdk libncursesw5-dev uuid-dev automake</code><br />Edit (or create) the file /etc/ld.so.conf and make sure it contains a line<br />with the string '/usr/local/lib/'.<br />Now, if you have <a href="http://eiresec.blogspot.com/2009/01/ocfa-installation-creating-temporary.html">created a temporary share</a> you can download the following files to that share. Direct links can be found below:<br /><a href="http://downloads.sourceforge.net/clucene/clucene-core-0.9.16.tar.gz?modtime=1158656947&amp;big_mirror=0">clucene 0.9.16 (tar.gz)</a> - <a href="http://sourceforge.net/project/showfiles.php?group_id=80013&amp;package_id=188504">Project Page</a> *extremely important the version is the same*<br /><a href="https://www.uitwisselplatform.nl/frs/download.php/192/libewf-beta-20061223.tar.gz">libewf-beta-20061233</a> - <a href="https://www.uitwisselplatform.nl/frs/?group_id=53">Project Page</a> *I am linking to 200612<span style="font-weight: bold;">23</span> I think 33 was a typo*<br />*OCFA2.2+ needs the newest libewf: <a href="https://www.uitwisselplatform.nl/projects/libewf/">libewf-20080501</a> <br /><a href="http://downloads.sourceforge.net/ocfa/libcarvpath-0.2.0.tar.gz?modtime=1205940853&amp;big_mirror=0">libcarvpath-0.1.4</a> - <a href="http://sourceforge.net/project/showfiles.php?group_id=170249">OCFA Project Page</a> *updated to 0.2.0*<br /><a href="http://downloads.sourceforge.net/ocfa/carvfs-0.4.1.tar.gz?modtime=1206021558&amp;big_mirror=0">carvfs-0.2.1</a> - OCFA *updated to 0.4.1*<br /><br />Once each is downloaded and on the server, the build is standard for each:<br />Extract each tar.gz by using the command 'tar -xvf (fileName).tar.gz'<br />Navigate into the newly decompressed folder, and run:<br /><code>./configure<br />make<br />make install</code><br />*I am not sure if the order matters, but just in case install in this order - clucene, libewf, libcarvpath, carvfs (as in the documentation)<br />After installing a library run 'ldconfig' to make sure the loader can find your libraries.<br /><br />Although I think this is old, I am going to install scalpel and the older version of sleuthkit:<br /><a href="http://downloads.sourceforge.net/sleuthkit/sleuthkit-2.07.tar.gz?modtime=1166192811&amp;big_mirror=0">sleuthkit-2.07</a><br />*lenny has scalpel as a package: apt-get install scalpel*<br /><a href="http://www.digitalforensicssolutions.com/Scalpel/scalpel-1.60.tar.gz">scalpel 1.60</a><br />The both install by just typing 'make' in their directory.<br /><br /><span style="font-weight: bold;">OCFA Install</span><br />Now it is finally time to start installing OCFA! Are you excited? I know I am.<br />Download <a href="http://downloads.sourceforge.net/ocfa/ocfa-2.1.1pl0.tar.bz2?modtime=1228409199&amp;big_mirror=0">OCFA</a> - <a href="http://sourceforge.net/project/showfiles.php?group_id=170249&amp;package_id=194242">Project Page</a> *currently 2.2.0<br /><br />These MUST be installed in order - OCFALib, OCFAArch, OCFAModules<br />Navigate to OCFALib, and run './configure'<br />You should not receive any errors, and all items in the list should be 'found'. If there are no errors, run 'make install'.<br />If there are errors attempt to find the package that is associated with the error using the apt-cache search method described above.<br />If you are really really really stuck, try the <a href="https://lists.sourceforge.net/lists/listinfo/ocfa-user">OCFA Mailing List</a>.<br /><br />While its building you should get some tea. mmMMmm.<br /><br />Eventually it will finish (hopefully with no errors). You can navigate directly to OCFAArch and start building it.<br />Again in OcfaArch run './configure' - it should 'find' everything. If not look for the packages before continuing.<br /><br />As of OCFA 2.2.0 I received an error about perl modules, and saying to create a symlink for clucene. Creating the symlink did not work for me, but installing the new clucene package in Lenny did. Also the following perl modules are now required:<br /><code>apt-get install libpg-perl libxml-dom-perl libclucene-dev</code><br /><b>Debian 4:</b><br />Once OcfaArch has been built it will ask to reconfigure the database - say yes.<br />A user 'ocfa' is created. I allow the ocfa user to create new roles.<br />yes - Allow the script to overwrite the apache config.<br />Choose (t)est or (p)roduction server.<br /><blockquote>The difference between these is that a testing system will allow you<br />to edit and tune your configuration without administrator priviledges.</blockquote><br /><b>Debian 5:</b> (this issue seems to be<br />fixed in ocfa 2.2)<br />In lenny the install failed to create a database user. If you are not prompted to reconfigure the database, the ocfa user was not created. To create the user manually see '<a href="https://DFIR.Science/2009/02/creating-and-modifying-user-in-psql.html">Creating and Modifying a User in PSQL</a>'. (must be done before pt. 3)<br /><br />Now restart the database:<br /><code>/etc/init.d/singlegresql-8.x restart</code><br />The documentation suggests you change the ocfa user's password: 'passwd ocfa'<br /><br />Now you have a working OcfaArch, which you can test - by following the instructions in 'ocfa/doc/usage/install/HOWTO-INSTALL-TEST.txt' HOWEVER, when accessing the interface you will receive the web error: 500 because permissions are not set correctly.<br /><br />At this point you can either continue installing the OcfaModules, or continue testing by going directly to the single 'pt.3 OCFA Installation - DNS, Apache and Permissions'<br />(I would suggest installing the modules)<br /><br />Okie dokie:<br />Navigate to the 'OcfaModules' directory. Run './configure | more' and check for errors. If everything went well you should only get one warning about 'dissector/photorec'. To remedy this error:<br /><blockquote>(part. 1)Since we have installed testdisk using apt, navigate to '/usr/local/sbin/'. If you have an executable called 'photorec', skip to (part 3). If you do not see photorec in sbin go to (part 2).<br /><br />(part 2) Building photorec from source. Download <a href="http://www.cgsecurity.org/testdisk-6.11-WIP.tar.bz2">photorec/testdisk</a> - <a href="http://www.cgsecurity.org/wiki/TestDisk_Download">Project Page</a>. I am using testdisk 6.11-WIP.<br /><ul><li>Extract the contents to your OCFA server and navigate to /testdisk-(versionNum)/</li><li>Run the command './configure --without-ncurses'</li><li>Then the normal 'make' and 'make install'</li><li>Navigate back to '/usr/local/sbin' and check for the existence of 'photorec'</li><li>If it is there continue to (part 3), if not attempt to build again.</li></ul>(part 3) Create a symbolic link from photorec - In version 2.1.1 OCFA searches for 'photorec_cli' rather than just 'photorec' in sbin.<br /><ul><li>Navigate to '/usr/local/sbin/'</li><li>(as root) type: 'ln -s photorec photorec_cli'</li></ul><br />Thanks to Jochen for a prompt response on this issue!</blockquote><br />*In OCFA 2.2.0 I received an error about a Transport::Dmx perl module. There is not a Debian package for it, so you need to install in manually. It can be downloaded from here <a href="http://search.cpan.org/~vparseval/Mail-Transport-Dbx-0.07/Dbx.pm">http://search.cpan.org/~vparseval/Mail-Transport-Dbx-0.07/Dbx.pm</a>. To install extract, navigate into the created directory, run 'perl Makefile.pl', make, make install. That should be it.<br />I also received an error about my java version telling me I would not be able to run jlucene. To fix this, edit the 'configure' file for OcfaModules, and in the function 'javaok' change the 'javac test.java' line to 'javac -source 5.0 test.java'.<br /><br />Build OcfaModules:<br />After fixing these issues, navigate back to OcfaModules, and run './configure'<br />With all the errors fixed, now run 'make'<br /><br />*On all the installs I have tried I receive an error dealing with 'Lucene'.<br />On Debian 5 it will complain about your java version and throw and say "jlucene will not be build". If you get this as well install the following package *installing this package did not fix the issue in OCFA 2.2.0*, see above:<br /><span style="font-weight: bold;">Do not uninstall 'clucene' package you built earlier!</span><code>apt-get install libclucene-dev</code><br />Also make sure you have 'ant' installed in lenny.<br /><br />Run './configure' again, then 'make'.<br />If you receive no errors, run 'make install'<br /><br />If it completes without error, you have a mostly-working OCFA install with Modules.<br /><br />Now before you go on to test you need to create the hash sets.<br /><a href="https://DFIR.Science/2009/01/ocfa-installation-creating-hash-sets.html">OCFA Installation - Creating the Hash Sets</a><br />~or~ if you are anxious to see OCFA in action check out<br /><a href="https://DFIR.Science/2009/01/pt3-ocfa-installation-dns-apache-and.html">pt.3 OCFA Installation - DNS, Apache and Permissions</a>