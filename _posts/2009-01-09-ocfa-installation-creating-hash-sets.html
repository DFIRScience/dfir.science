---
layout: posts
title: "OCFA Installation - Creating the Hash Sets"
date: '2009-01-09T21:24:00.000+09:00'
author: Joshua
tags:
- HowTo
modified_time: '2015-08-24T22:35:19.248+09:00'
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-5798442301934443382
blogger_orig_url: https://DFIR.Science/2009/01/ocfa-installation-creating-hash-sets.html
---

Maybe I am just a novice, but I had a hard time figuring out the inputs for the creation of the hash database for the OCFA digest module. This step can be found at the end of the 'HOWTO-INSTALL-debian-etch.txt' within /ocfa/doc/usage/install/<br /><br /><blockquote>If you are installing the publicly available ocfa distribution<br />you will not have the pre-build databases available and you will<br />thus need to build the digest files yourself.</blockquote><br />The digest database files can be downloaded from <a href="http://www.nsrl.nist.gov/Downloads.htm">http://www.nsrl.nist.gov/Downloads.htm</a><br /><br />I have not been able to find the other accepted hash-sets for cp images. I will single a link when I find it. If you know where they are, please let me know. All I know was in the README - file name kp1.hke - cp hashset of BDE Nijmegen<br /><br /><ul><li>Once you have downloaded the NIST disks (currently 1 - 4, about 300MB each), you shoud verify the files, then mount the ISOs. </li><li>In the base directory of each will be a RDS_222X.ZIP folder (where X is A - D).</li><li>Extract the contents of RDS_222X.ZIP.</li><li>For convenience create a folder called 'hash' to put each file in.</li><li>In the RDS_222X folder copy the 'NSRLProd.txt' and the 'NSRLFile.txt' into your newly created 'hash' folder.</li><li>You only need to copy 'NSRLProd.txt' once. They are they same in each ISO.</li><li>Rename 'NSRLFile.txt' to a unique name for each. I used A.txt, B.txt, C.txt, D.txt.</li><li>If you were not working on your local OCFA server, copy the hash folder to the server now (it will greatly speed up the processing).</li><li>On the OCFA server navigate to the OCFA source folder (where you build ocfa from).</li><li>From within the source folder navigate to 'OcfaModules/minimal/digest/init/'</li><li>You should find a script called 'createshadb2.pl'</li><li>Run the script with './createshadb2.pl' </li><li>You should get the message:</li></ul><blockquote>Give sourcename,productinfo file and a list of digest files or send an end of file:</blockquote><ul><li>The sourcename is 'NIST', the productinfo is the 'NSRLProd.txt' file, and the list of digest files is the 'NSRLFile.txt' files separated by a space.</li><li>For example, using the ocfaShare described in <a href="http://eiresec.blogspot.com/2009/01/ocfa-installation-creating-temporary.html">this</a> single, and saving my hashes in a folder called 'hash' - I would use the following command:<code>./createshadb2.pl<br />NIST /ocfaShare/hash/NSRLProd.txt /ocfaShare/hash/A.txt<br />/ocfaShare/hash/B.txt /ocfaShare/hash/C.txt<br /> /ocfaShare/hash/D.txt</code></li><li>If everything is working the hash DB will start building. Mine took about two hours.</li><li>Once done, copy 'adinfodb', 'digestdb' and 'proddb' from 'ocfa/OcfaModules/minimal/digest/init/' to '/usr/local/digiwash2.1/static/hashsets/'</li></ul>