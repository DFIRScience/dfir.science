---
layout: single
title: "Video Screenshot Preview gif Built from Command-Line Linux"
date: '2010-09-10T02:49:00.000+09:00'

tags:
- HowTo
modified_time: '2015-08-24T22:35:19.145+09:00'
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-3233543605331744988
blogger_orig_url: https://DFIR.Science/2010/09/video-screenshot-preview-gif-built-from.html
---

*Edit: This version will produce errors when using a file list. See <a href="https://DFIR.Science/2010/09/video-preview-from-command-line-with.html">this single</a> for a more reliable way.<br /><br />I have been searching for a while for a way to create a video preview from the command line in Linux. Not just a simple screen shot, but an animated gif of screen shots throughout the video. My thinking is that a screen shot of a video at a random time may not look suspicious, but the next frame may be something illegal. Essentially for a video I would like to take 4 - 6 screen shots regardless of the duration, compile these into an animated gif, and display the preview.<br /><br />First I have been looking at my options:<br />I am on Debian 'Lenny', and while vlc might look like a good option, the lenny release is stuck at 0.8.6. The newest release is 1.1.4 (I think), but in 0.8.6 the --start-time switch is ignored. I tried upgrading using sid, but ran into a bunch of problems and decided not to mess with it.<br /><br />I looked into mplayer which created screen shots, but I could not easily find how to divide the duration into 6, and quickly take the snap shot at those times. Basically I just got a bunch of sequential snapshots, and when I put them together would make the video again. I could delete some in the middle to get the desired effect, but thought there had to be an easier way. Also mplayer gui always wanted to start, and I did not want that.<br /><br />Finally<a href="http://ffmpeg.org/" target="_blank"> ffmpeg</a> - with ffmpeg and imagemagick I was able to get something similar to what I wanted.<br /><br />First the ffmpeg line<br /><br /><code><br />ffmpeg -i $file -ss 120 -t 120 -r 0.05 -s 90x90 f%d.jpg</code><br /><br />What this does is takes the input video file '$file', starts at 2 minutes (-ss 120), runs for 2 minutes (-t 120), sets a very low frame rate (-r 0.05), re-sizes the preview to 90x90px (-s 90x90), and names all the output images f#.jpg (f%d.jpg). Rather than calculating the duration, making the frame rate low gives a similar effect. I will write duration calculation later.<br /><br />So once we run that we have a directory full of *.jpg files. We need to roll them into one animated gif. For this I use imagemagick. I have seen a lot of people who are using gimp for this. I love gimp, but imagemagick is easier converting a bunch of jpgs to an animated gif.<br /><br /><code><br />convert -delay 100 -loop 0 f*.jpg $file.gif</code><br />*adapted from <a href="http://ubuntuforums.org/showthread.php?t=1034104">here</a><br /><br />This will group all the jpg files in a loop with approx a 1 second pause per image. Works a treat!<br /><br />Here is the first preview I tested (have only tested with .ogm and .mp4 so far)<br /><a href="http://cybercrimetech.files.wordpress.com/2010/09/zx-flcl_-01-divx51-ogm_1.gif"><img alt="Video Screenshot Preview gif - FLCL" class="aligncenter size-full wp-image-234" src="http://cybercrimetech.files.wordpress.com/2010/09/zx-flcl_-01-divx51-ogm_1.gif" title="flcl.01.ogm" /></a><br /><br /><br />Here is my full bash script to do the processing. It takes a file name as an argument - the loop is to deal with file names with spaces.<br /><br /><code><br />#!/bin/bash<br />echo "$1" | while read file<br />do<br />        if [ -f "$file" ]; then<br />                echo "Creating preview of $file"<br />                ffmpeg -i "$file" -ss 120 -t 120 -r 0.05 -s 90x90 f%d.jpg<br />                fn=$(echo ${file// /})  # Remove spaces in filename<br />                convert -delay 100 -loop 0 f*.jpg $fn.gif<br />                rm *.jpg<br />        fi<br />done<br />exit 0</code>