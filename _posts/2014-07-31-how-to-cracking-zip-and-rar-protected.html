---
layout: single
title: "How-to - Cracking ZIP and RAR protected files with John the Ripper"
date: '2014-07-31T17:00:00.000+09:00'
author: Joshua
tags:
- Linux
- Password Cracking
- HowTo
modified_time: '2015-08-24T22:35:19.089+09:00'
thumbnail: http://2.bp.blogspot.com/-WGf9KhJiN40/U9TiU7AzjFI/AAAAAAAAAzg/Zj_86E69MxE/s72-c/jtr.png
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-1500654509762518082
blogger_orig_url: https://DFIR.Science/2014/07/how-to-cracking-zip-and-rar-protected.html
---

After seeing how to <a href="https://DFIR.Science/2014/07/how-to-compiling-john-ripper-to-use-all.html" target="_blank">compile John the Ripper to use all your computer's processors</a>&nbsp;now we can use it for some tasks that may be useful to digital forensic investigators: getting around passwords. Today we will focus on cracking passwords for ZIP and RAR archive files. Luckily, the JtR community has done most of the hard work for us. For this to work you need to have built the community version of John the Ripper since it has extra utilities for ZIP and RAR files.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-WGf9KhJiN40/U9TiU7AzjFI/AAAAAAAAAzg/Zj_86E69MxE/s1600/jtr.png" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" src="http://2.bp.blogspot.com/-WGf9KhJiN40/U9TiU7AzjFI/AAAAAAAAAzg/Zj_86E69MxE/s1600/jtr.png" height="181" width="200" /></a></div>For this exercise I have created password protected RAR and ZIP files, that each contain two files.<br /><br /><pre><br />test.rar: RAR archive data, v1d, os: Unix<br /> <br />test.zip: Zip archive data, at least v1.0 to extract <br /></pre>The password for the rar file is 'test1234' and the password for the zip file is 'test4321'.<br /><br />In the 'run' folder of John the Ripper community version (I am using John-1.7.9-jumbo-7), there are two programs called 'zip2john' and 'rar2john'.  Run them against their respective file types to extract the password hashes: <br /><pre><br />./zip2john ../test.zip &gt; ../zip.hashes<br />./rar2john ../test.rar &gt; ../rar.hashes<br /></pre>This will give you files that contain the password hashes to be cracked... something like this: <br /><pre><br />../test.zip:$pkzip$2*2*1*0*0*1b*a80c*95e4e9547dcfcde4b8b2f05a80aaeb9d15dd76e7526b81803c8bf7*2*0*1b*f*72051312*0*44*0*1b*a808*cbafdd390bf49ea54064ab3ff9f486e6260b9854e37d1ee3a41c54*$/pkzip$<br /></pre>After, that you can run John the Ripper directly on the password hash files:<br /><pre>./john ../zip.hashes<br /></pre>You should get a message like: <code> Loaded 1 password hash (PKZIP [32/64])</code>. By using John with no options it will use its default order of cracking modes. See the <a href="http://www.openwall.com/john/doc/EXAMPLES.shtml" target="_blank">examples page </a>for more information on modes.<br /><br />Notice, in this case we are not using explicit dictionaries. You could potentially speed the cracking process up if you have an idea what the password may be. If you look at your processor usage, if only one is  maxed out, then you did not enable OpenMP when building. If you have a multi-processor system, it will greatly speed up the cracking process.<br /><br />Now sit back and wait for the cracking to finish. On a 64bit quad-core i7 system, without using GPU, and while doing some other CPU-intensive tasks, the password was cracked in 6.5 hours. <br /><pre><br />Loaded 1 password hash (PKZIP [32/64])<br /><br />guesses: 0  time: 0:00:40:29 0.00% (3)  c/s: 2278K  trying: eDTvw - ekTsl<br />guesses: 0  time: 0:01:25:10 0.00% (3)  c/s: 1248K  trying: ctshm#ni - ctshfon9<br />guesses: 0  time: 0:02:56:40 0.00% (3)  c/s: 1499K  trying: BR489a - BR48jf<br />guesses: 0  time: 0:03:56:04 0.00% (3)  c/s: 1703K  trying: fjmis5od - fjmidia0<br />guesses: 0  time: 0:04:46:09 0.00% (3)  c/s: 1748K  trying: Difg1ek - DifgbpS<br />guesses: 0  time: 0:05:21:22 0.00% (3)  c/s: 1855K  trying: btkululp - btkulene<br />guesses: 0  time: 0:06:02:43 0.00% (3)  c/s: 1857K  trying: ghmnymik - ghmnyasd<br />test4321         (../test.zip)<br />guesses: 1  time: 0:06:32:34 DONE (Mon Jul 28 17:50:22 2014)  c/s: 1895K  trying: telkuwhy â€“ test43ac<br /></pre>Now if you want to see the cracked passwords give john the following arguments: <br /><pre><br />./john ../zip.hashes --show<br /></pre>It should output something like:<br /><pre><br />../test.zip:test4321 <br />1 password hash cracked, 0 left <br /></pre>Note: the hash file should have the same type of hashes. For example, we cannot put the rar AND zip hashes in the same file. But this means you could try to crack more than one zip/rar file at a time.<br /><br />For the rar file it did not take nearly as long since the password was relatively common. If you take a look at john.conf in the run directory, it has a list of the patterns it checks (in order). The pattern 12345 is much more likely than 54321, so it is checked first resulting in a quick crack. <br /><pre><br />Loaded 1 password hash (RAR3 SHA-1 AES [32/64]) <br /><br />guesses: 0  time: 0:00:00:10 1.38% (1) (ETA: Mon Jul 28 18:23:58 2014)  c/s: 24.86  trying: rar.tsett - ttests <br /><br />guesses: 0  time: 0:00:02:12 13.40% (1) (ETA: Mon Jul 28 18:28:19 2014)  c/s: 25.98  trying: Test29 - Test2rar9 <br /><br />test1234         (test.rar) <br /><br />guesses: 1  time: 0:00:17:03 DONE (Mon Jul 28 18:28:56 2014)  c/s: 24.01  trying: test1234 - testrar1234 <br /><br />Use the "--show" option to display all of the cracked passwords reliably <br /><br /></pre>