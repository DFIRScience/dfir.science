---
layout: posts
title: "Modifying Javascript Variables Real Time with Chrome aka AdBlock Detection Subversion"
date: '2015-05-20T21:07:00.000+09:00'
author: Joshua
tags:
- javascript
- HowTo
modified_time: '2015-08-24T22:35:19.234+09:00'
thumbnail: https://2.bp.blogspot.com/O0aW5qsyCkR2i7Bu-jUU1b5BWA_NygJ6ui4MgaAvL7gfqvVWqkOBscDaq4pn-vkwByUx=s72-w300-c
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-5609055328387849198
blogger_orig_url: https://DFIR.Science/2015/05/modifying-javascript-variables-real.html
---

Sometimes you may want to see what scripts a website is trying to run on your system. Other times you may want to be able to not only watch, but also modify javascript variables.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/O0aW5qsyCkR2i7Bu-jUU1b5BWA_NygJ6ui4MgaAvL7gfqvVWqkOBscDaq4pn-vkwByUx=w300" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"><img border="0" height="200" src="https://2.bp.blogspot.com/O0aW5qsyCkR2i7Bu-jUU1b5BWA_NygJ6ui4MgaAvL7gfqvVWqkOBscDaq4pn-vkwByUx=w300" width="200" /></a></div>Doing this with <a href="https://www.google.com/chrome/" target="_blank">Google Chrome</a> is relatively easy. After opening chrome, open "Developer Tools" either from <i>Menu -&gt; More tools -&gt; Developer tools </i>or with ctrl+shift+I.<br /><br />From the top of the developer tools menu, choose "Sources", and the source file you would like to look at. From here you should be able to see what the website is trying to run (just like <i>view source</i> with more information).<br /><br />Form here there are many things that you can do. For a more comprehensive list, please see the <a href="https://developer.chrome.com/devtools" target="_blank">Chrome DevTools Overview</a>.<br /><br /><b>Setting Javascript Variables</b><br />One of the most useful things about chrome developer tools is the ability to set javascript variables.<br /><br />An example that I find often is sites using javascript to detect adblock software. When doing research on sites that might be malicious, you may want to access all features of the site without enabling ads (or other potentially malicious stuff). However, some sites will redirect or do other tricks when ad blocker software is detected.<br /><br /><b>Example adBlock detection script</b> (real code I found at a random site):<br /><br /><pre>            var isBlockAds = true;<br />            $(function () {<br />                setTimeout('DoDetect()', 3000);<br />            });<br /><br />            function CheckAdImage(elem) {<br />                if (elem.is(":visible")) {<br />                    isBlockAds = false;<br />                    elem.hide();<br />                }<br />            }<br />            <br />            function DoDetect() {<br />                CheckAdImage($('#adElement'));<br />                if (isBlockAds) {<br />                    // redirect to new page<br />                    });<br />                }<br />            }<br /></pre><br />This javascript code is doing a few things. First the variable "isBlockAds" is set to true. The next function runs the "DoDetect" function after 3 seconds. DoDetect calls CheckAdImage with the element identifier to check. If the element is visible on the page (not blocked) then isBlockAds is set to false. If isBlockAds is true at the end of the process, then redirect the page to somewhere else.<br /><br />The end result is that if you are blocking ads, then you can use the page for a short period, but then are redirected to a new, possibly malicious page.<br /><br />So how can we get around this? With the chrome developer tools do the following:<br /><br /><ul><li>Open the target webpage</li><li>Under the list of sources, hit the pause button:&nbsp;<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-cTBc3l9Gr8o/VVxzxSKLb9I/AAAAAAAAA8A/KwXdw_UwxEk/s1600/pause.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-cTBc3l9Gr8o/VVxzxSKLb9I/AAAAAAAAA8A/KwXdw_UwxEk/s1600/pause.png" /></a></div></li><li>Under "console" at the bottom, there is a white box with a &gt; character. You can type here.&nbsp;<div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-hCgk9Nepg-M/VVx0RwtW9BI/AAAAAAAAA8I/YbsgQ-Ly7mM/s1600/console.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="87" src="http://3.bp.blogspot.com/-hCgk9Nepg-M/VVx0RwtW9BI/AAAAAAAAA8I/YbsgQ-Ly7mM/s320/console.png" width="320" /></a></div></li><li>In the console you can set <b>global variables</b>. Here we will set our variable isBlockAds to false:&nbsp;<div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-mbB-SMvkl5M/VVx1Pu1vX_I/AAAAAAAAA8U/5mEPxbFscvA/s1600/setfalse.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="117" src="http://2.bp.blogspot.com/-mbB-SMvkl5M/VVx1Pu1vX_I/AAAAAAAAA8U/5mEPxbFscvA/s320/setfalse.png" width="320" /></a></div></li><li>If the variable has already be defined, developer tools will should autocomplete. If not, you can set it. Note: in our example if we set isBlockAds before it is defined in the page, it will be reset to true later.</li></ul><div>That is it. In this case, hitting the pause button allows us to find the variable we want to change before the page redirects. We can then use the console to check and set any variables we want.</div><div><br /></div><div>For example, if we want to see the value of a random variable we can do something like:</div><div><br /></div><pre>   console.log(iswhatsappCustomButton);<br />   false<br /></pre><div><br /></div><div>Check out&nbsp;<a href="https://developer.chrome.com/devtools" target="_blank">Chrome DevTools Overview</a>&nbsp;for much more information.</div><br /><br /><br /><br />