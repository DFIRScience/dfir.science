---
layout: single
title: "Honeypot Fun"
date: '2016-04-29T10:59:00.002+09:00'

tags:
- Infosec
- honeypot
modified_time: '2016-04-29T10:59:38.221+09:00'
thumbnail: https://3.bp.blogspot.com/-tpY53516vAs/VyK3zBv1EqI/AAAAAAAABDM/Mat6AG4dPAciB9c6mV5pB2WVUltVB_TUQCLcB/s72-c/honeybee-153223_640.png
blogger_id: tag:blogger.com,1999:blog-2701259639305045003.single-1997849047857211827
blogger_orig_url: https://DFIR.Science/2016/04/honeypot-fun.html
---

At the <a href="http://cis.hallym.ac.kr/" target="_blank">Legal Informatics and Forensic Science Institute</a>, we are preparing to do some research on IoT smart homes. Part of that is setting up a slightly-less-secure system. I run some honeypots on my home networks, but I was interested to see what is coming in to the known University IP range.<br /><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://3.bp.blogspot.com/-tpY53516vAs/VyK3zBv1EqI/AAAAAAAABDM/Mat6AG4dPAciB9c6mV5pB2WVUltVB_TUQCLcB/s1600/honeybee-153223_640.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="200" src="https://3.bp.blogspot.com/-tpY53516vAs/VyK3zBv1EqI/AAAAAAAABDM/Mat6AG4dPAciB9c6mV5pB2WVUltVB_TUQCLcB/s200/honeybee-153223_640.png" width="181" /></a></div><div>I had an extra Raspberry Pi laying around, and decided to run <a href="https://github.com/micheloosterhof/cowrie" target="_blank">cowrie</a>&nbsp;(kippo) SSH honeypot. Mostly because it is very fast to set up, gives you an idea of where attacks are coming from, and also gives a list of usernames and passwords that people are trying. More on the setup of cowrie later.</div><div><br /></div><div>After putting cowrie online, it took <b>28 minutes</b> before the first connection. This is actually longer than I expected. Possibly because the IP was up before, but port 22 was not open.</div><div><br /></div><div>After 12 hours, login attempts from the following addresses:</div><div><br /></div><div><table>  <thead><tr>    <th class="tg-yw4l">Login Attempts</th>    <th class="tg-yw4l">IP Address</th> <th class="tg-yw4l">Country</th>  </tr></thead>  <tbody><tr>    <td class="tg-yw4l">1</td>    <td class="tg-yw4l">146.66.163.107</td><td class="tg-yw4l">Russia</td>  </tr><tr>    <td class="tg-yw4l">3</td>    <td class="tg-yw4l">185.103.252.14</td><td class="tg-yw4l">Russia</td>  </tr><tr>    <td class="tg-yw4l">9</td>    <td class="tg-yw4l">195.154.58.76</td><td class="tg-yw4l">France</td>  </tr><tr>    <td class="tg-yw4l">18</td>    <td class="tg-yw4l">159.122.123.183</td><td class="tg-yw4l">Germany</td>  </tr><tr>    <td class="tg-yw4l">40</td>    <td class="tg-yw4l">117.102.109.18</td><td class="tg-yw4l">Indonesia</td>  </tr><tr>    <td class="tg-yw4l">41</td>    <td class="tg-yw4l">193.201.227.200</td><td class="tg-yw4l">Ukraine</td>  </tr><tr>    <td class="tg-yw4l">91</td>    <td class="tg-yw4l">94.79.5.102</td><td class="tg-yw4l">Russia</td>  </tr><tr>    <td class="tg-yw4l">126</td>    <td class="tg-yw4l">193.201.227.86</td><td class="tg-yw4l">Ukraine</td>  </tr><tr>    <td class="tg-yw4l">336</td>    <td class="tg-yw4l">202.83.25.95</td>    <td class="tg-yw4l">India</td>  </tr></tbody></table><br />Remember that the country doesn't actually mean anything. These could be proxies, tor, hacked servers, etc.<br /><br />The top usernames and passwords are not very surprising.<br /><br /><table class="tg"><tbody><tr>    <th class="tg-yw4l">Tries</th>    <th class="tg-yw4l">Username / Password</th>  </tr><tr>    <td class="tg-yw4l">21</td>    <td class="tg-yw4l">[root/123456]</td>  </tr><tr>    <td class="tg-yw4l">19</td>    <td class="tg-yw4l">[root/default]</td>  </tr><tr>    <td class="tg-yw4l">18</td>    <td class="tg-yw4l">[admin/support]</td>  </tr><tr>    <td class="tg-yw4l">18</td>    <td class="tg-yw4l">[admin/default]</td>  </tr><tr>    <td class="tg-yw4l">18</td>    <td class="tg-yw4l">[admin/123123]</td>  </tr><tr>    <td class="tg-yw4l">8</td>    <td class="tg-yw4l">[root/admin]</td>  </tr><tr>    <td class="tg-yw4l">6</td>    <td class="tg-yw4l">[admin/admin]</td>  </tr><tr>    <td class="tg-yw4l">5</td>    <td class="tg-yw4l">[test/test]</td>  </tr><tr>    <td class="tg-yw4l">5</td>    <td class="tg-yw4l">[support/support]</td>  </tr><tr>    <td class="tg-yw4l">5</td>    <td class="tg-yw4l">[root/qwerty]</td>  </tr></tbody></table></div><br />Probably the most interesting thing is that the first attack was that the first attack was trying some sort of buffer-overflow. Although they were connecting to SSH and sending (weird) user/pass combinations, after the connection was rejected they were sending really long strings. I suspect it is some sort of honeypot detection, or it exploits certain versions of SSH? Not sure.<br /><br />Anyway, for a 1 hour project it is easy and interesting. Definitely something that students could do in an afternoon.